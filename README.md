# The Boring News | Tech News Aggregator

Simple, efficient, and developer-focused tech news aggregator. "No noise, just signal."

## ðŸ— System Architecture

The system is built as a monolithic Next.js application that handles both the frontend UI and the backend ingestion logic. It leverages serverless database connections for scalability and performance.

```mermaid
graph TD
    User[User] -->|HTTP Request| CDN[Edge / CDN]
    CDN -->|Next.js App Router| App[Next.js Server]
    
    subgraph "Ingestion Worker (Cron/Script)"
        Ingestor[Ingestion Service] -->|Fetch RSS| ExternalSources[External RSS Feeds]
        Ingestor -->|Parse & Normalize| Parser[RSS Parser]
        Parser -->|Deduplicate & Store| DB
    end

    subgraph "Data Layer"
        App -->|Server Actions / SQL| DB[(Neon PostgreSQL)]
    end

    App -->|Rendering| UI[React UI Components]
```

## ðŸ›  Tech Stack

- **Framework**: [Next.js 16](https://nextjs.org/) (App Directory, Server Actions)
- **Language**: TypeScript
- **Styling**: Tailwind CSS v4, `lucide-react` for icons.
- **Database**: PostgreSQL (via [Neon Serverless](https://neon.tech/))
- **Database Driver**: `@neondatabase/serverless` with custom SQL wrapper.
- **Ingestion**: `rss-parser` for normalizing feed data.
- **Fonts**: Geist Sans, Geist Mono, Roboto, Boldonse.

## ðŸ’¾ Database Schema

The database relies on a relational model to store sources and articles.

```mermaid
erDiagram
    SOURCES ||--o{ ARTICLES : "publishes"
    ARTICLES }|--|{ CATEGORIES : "verified_in"

    SOURCES {
        uuid id PK
        string name
        string feed_url UK
        boolean enabled
    }

    ARTICLES {
        uuid id PK
        string title
        string summary
        string short_summary
        string extended_summary
        string url UK
        string image
        datetime published_at
        uuid source_id FK
    }

    CATEGORIES {
        uuid id PK
        string name
    }
```

### Key Design Decisions

1.  **Deduplication Strategy**:
    *   Articles are uniquely identified by their `url`.
    *   Ingestion logic (`lib/ingestor.ts`) checks for existing URLs before insertion to prevent duplicates.
    *   `extended_summary` is generated by truncating content to 400 chars to avoid storing full articles (avoiding copyright issues).

2.  **Hybrid Rendering**:
    *   **ISR (Incremental Static Regeneration)**: The main feed (`app/page.tsx`) uses `export const revalidate = 60` to cache the feed for 1 minute, handling high traffic without hitting the DB on every request.
    *   **Server Components**: Data fetching happens on the server, sending hydrated HTML to the client for optimal SEO and performance.

3.  **Database Access**:
    *   Uses a lightweight custom wrapper around `neondatabase/serverless` in `lib/db.ts` to support standard parameterized queries (`sql` template literal).

## ðŸ”„ Core Workflows

### 1. News Ingestion
The ingestion process is designed to be idempotent.
`scripts/test-ingest.ts` -> `lib/ingestor.ts`
1.  Fetch all enabled `sources`.
2.  For each source, fetch the RSS feed.
3.  Filter out items without links or titles.
4.  Check DB for existence of `item.link`.
5.  If new, insert into `articles` with normalized summary.

### 2. Serving News
`app/page.tsx` -> `lib/actions.ts` -> `getArticles()`
1.  Frontend requests page.
2.  Server Action `getArticles` is called.
3.  Constructs SQL query with filtering (search, category) and pagination support.
4.  Returns typed `ArticleWithSource[]` objects.

## ðŸš€ Getting Started

### Prerequisites
- Node.js 18+
- PostgreSQL Database (Neon recommended)

### Setup

1.  **Clone & Install**
    ```bash
    git clone <repo>
    npm install
    ```

2.  **Environment Variables**
    Create `.env`:
    ```env
    DATABASE_URL="postgres://user:pass@endpoint.neon.tech/neondb?sslmode=require"
    PERPLEXITY_API_KEY="pplx-..."   # Optional: for AI summaries in article modal (Perplexity Chat Completions)
    ```

3.  **Database Initialization**
    ```bash
    npm run db:init  # Creates tables
    npm run db:seed  # Seeds initial sources
    ```

4.  **Run Ingestion**
    ```bash
    npx tsx scripts/test-ingest.ts
    ```

5.  **Start Dev Server**
    ```bash
    npm run dev
    ```
